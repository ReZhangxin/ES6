<!-- 
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>MoJu-Music</title>
	<link rel="stylesheet" href="./src/css/sound.css">
	<script src="src/js/jquery-1.11.3.min.js"></script>
</head>
<body>
	<div class="music-well">
		
		<nav>
			<div class="logo">MoJu-Music</div>
			<div class="found">发现音乐</div>
			<div class="fm">频道</div>
			<div class="lib">曲库</div>
		</nav>
	</div>
	<div class="wrapper">
		<div class="sound-info">
			
			<h2 class="sound-title"><span class="jvc-name"></span></h2>
			<div class="sound-img">
				<img src="" class="jvc-cover" width='300'>
				<div class="audio-control">
					<a href="javascript:void(0)" id="play">►</a>
					
				</div>
			</div>			
			<div><span class="jvc-fm"></span></div>

			
			
			<p class="describtion">
				<span class="jvc-info"></span>
			</p>
		</div>
	
		<div class="sound-comments">
			<h2>热门评论</h2>

			<div class="comments"></div>
		</div>

	</div>
	

	<div id="template" style="display: none;">
		<div id="template-comment">
			<p class="author"><span class="jvc-name"></span>
				<span class="jvc-date f-right"></span>
			</p>	
			<img class="jvc-avatar">
			
			<p class="content"><span class="jvc-content"></span></p>
		</div>
	</div>


	<audio id="audio" class="jvc-audio"></audio>
</body>
</html>
<script type="text/javascript">
	var id = location.search;
	id= id.substring(4,id.length);
	
	// 获取专辑详细信息
	$.ajax({
		url:'http://47.94.100.222/change.php',
		dataType:'json',
		data:{'url':'http://www.app-echo.com/api/sound/info?id='+id+'&comment=1'},
		type:'POST',
		success:function(res){
			console.log(res);
			$('.jvc-name').html(res.info.name);
			$('.jvc-fm').html(res.info.channel.name);
			$('.jvc-cover').attr('src',res.info.pic);
			$('.jvc-info').html(res.info.info);
			$('.jvc-audio').attr('src',res.info.source);
			for(var i=0;i<res.comments.length;i++)
			{
				var id='comment-'+i;
				var comment=res.comments[i]
				$('#template-comment').clone().attr('id',id).appendTo($('.comments')).show();
				$('#'+id).find('.jvc-name').html(comment.user.name);
				$('#'+id).find('.jvc-avatar').attr('src',comment.user.avatar);
				$('#'+id).find('.jvc-date').html(comment.create_time);
				$('#'+id).find('.jvc-content').html(comment.content);
			}
		}
	})

	
	// $('#play').on('click',function(){
	// 	document.getElementById('audio').play();
	// })
	// $('#pause').on('click',function(){
	// 	document.getElementById('audio').pause();
	// })
	const audio = document.getElementById('audio');
	const playM = document.getElementById('play');
	function player(){
		const method = audio.paused ? 'play' : 'pause';
		audio[method]();
	}
	function text(){
		const icon = audio.paused ? '►' : '❚ ❚';
		playM.textContent = icon;
	}
	playM.addEventListener('click',player);
	playM.addEventListener('click',text);
</script> -->
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>MoJu-Music</title>
    <link rel="stylesheet" type="text/css" href="music.css">
    <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
</head>
<body>
	<div class="music-well">
		<!-- 导航 -->
		<nav>
			<div class="logo">MoJu-Music</div>
			<div class="found">发现音乐</div>
			<div class="fm">频道</div>
			<div class="lib">曲库</div>
		</nav>
		<div class="music-content">
			<!-- 榜单 -->
			<div class="lists">
				<h1>榜单</h1>
				<div class="lists-content">
					<div class="list list-1">
						<a href="javascript:void(0)">热门回声榜</a>
					</div>
					<div class="list list-2">
						<a href="javascript:void(0)">原创回声榜</a>
					</div>
					<div class="list list-3">
						<a href="javascript:void(0)">视频回声榜</a>
					</div>
					<div class="list list-4">
						<a href="javascript:void(0)">名人</a>
					</div>
					<div class="list list-5">
						<a href="javascript:void(0)">专辑</a>
					</div>
				</div>
			</div>

			<!-- contents -->
			<div class="contents">
				<div class="recommends">
					<h1>今日推荐</h1>
					<div class="recommend"></div>
				</div>
				<div class="hot_recommend">
					<h1>每日精选</h1>
					<div class="hot"></div>
				</div>
			</div>
		</div>
	</div>

	<div id="template" class="template">
		<div id="template-recommend" class="tpl-recommend">
			<a class="template-cover jvc-link"><img src="" class="jvc-cover"></a>
			<p class="jvc-name"></p>
			<p class="jvc-fm"></p>
			<span><i class="icon-share"></i><b class="jvc-share"></b></span>
			<span><i class="icon-like"></i><b class="jvc-like"></b></span>
			<span><i class="icon-comment"></i><b class="jvc-comment"></b></span>
		</div>
		<div id="template-hot" class="tpl-hot">
			<p class="hot-cover"><img src="" class="jvc-cover"></p>
			<div class="hot-info">
				<p class="jvc-name"></p>
				<p class="jvc-tag"></p>
			</div>
		</div>
	</div>
</body>
</html>
<script>
	$(function(){
		// 获取今日推荐内容
		$.ajax({
			url:'http://47.94.100.222/change.php',
			dataType:'json',
			type:'POST',
			data:{'url':'http://www.app-echo.com/api/recommend/sound-day?page=1'},
			success:function(res){
				var lists=res.list;
				console.log(lists);
				for(var i=0;i<lists.length;i++)
				{
					var id='list-'+i;
					$('#template-recommend').clone().attr('id',id).appendTo($('.recommend')).show();
					$('#'+id).find('.jvc-cover').attr('src',lists[i].sound.pic)
					$('#'+id).find('.jvc-name').html(lists[i].sound.name)
					$('#'+id).find('.jvc-fm').html(lists[i].sound.channel.name)
					$('#'+id).find('.jvc-share').html(lists[i].sound.share_count)
					$('#'+id).find('.jvc-like').html(lists[i].sound.like_count)
					$('#'+id).find('.jvc-comment').html(lists[i].sound.comment_count)
					$('#'+id).find('.jvc-link').attr('href','sound.html?id='+lists[i].obj_id)
				}
			}
		})

		// 获取每日精选内容
		$.ajax({
			url:'http://47.94.100.222/change.php',
			dataType:'json',
			data:{'url':'http://www.app-echo.com/api/other/index'},
			type:'POST',
			success:function(res){
				var lists=res.hot_recommend;
				// console.log(lists);
				for(var i=0;i<lists.length;i++)
				{
					var id='hot-'+i;
					$('#template-hot').clone().attr('id',id).appendTo($('.hot')).show();
					$('#'+id).find('.jvc-cover').attr('src',lists[i].pic);
					$('#'+id).find('.jvc-name').html(lists[i].name);
					$('#'+id).find('.jvc-tag').html(lists[i].channel.name)
				}
			}
		})
	})
	
	
</script>